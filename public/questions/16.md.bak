# 母题Q16: RateLimiter + Grafana - 限流监控
> 细分类: 网关、限流与负载均衡
> 大类: URL/网关/流量治理
> 目标: 入口流量治理与故障隔离

## 0. 使用说明
- 先讲P0边界和SLO，再讲架构细节。
- 每个结论都要给：指标、边界、失败兜底、验证方式。
- 这份文档可以直接当作45~60分钟面试答题脚本。

## 1. P0边界与SLO
| 维度 | 目标 | 验证方式 |
|---|---|---|
| 核心链路稳定 | >=99.95%可用 | 演练故障后10分钟内恢复 |
| 高并发处理 | 峰值3x可承载 | 压测+灰度放量 |
| 一致性保障 | 关键状态零丢失 | 幂等+补偿+对账 |
| 故障恢复 | RTO<10分钟 | 自动化Runbook |
| 成本优化 | 单位请求成本下降 | 月度成本报表 |

## 2. 关键业务链路
- 链路1: 接入鉴权
- 链路2: 配额判定
- 链路3: 路由转发
- 链路4: 熔断降级
- 链路5: 灰度放量
- 链路6: 回滚恢复

## 3. 容量估算模板
- 日请求量 = DAU × 人均请求次数
- 平均QPS = 日请求量 / 86400
- 峰值QPS = 平均QPS × 峰值系数（通常3~5）
- 单机容量来自压测，不可拍脑袋。
- 运行水位建议：70%常态，80%预警，90%自动扩容。

## 4. 架构总览
```text
Client -> Gateway -> API Service -> Cache -> Primary Store
                       |                 |
                       +-> MQ -> Worker -+
                       |
                       +-> Observability
```

## 5. 组件职责、容量、故障策略
### 5.1 Gateway
- 职责：重点保障`接入鉴权`。
- 容量：以峰值QPS和压测结果设定实例数。
- 故障策略：限流/熔断/降级/自动扩容/回滚。
- 观测指标：QPS、P95/P99、错误率、资源水位。

### 5.2 API Service
- 职责：重点保障`配额判定`。
- 容量：以峰值QPS和压测结果设定实例数。
- 故障策略：限流/熔断/降级/自动扩容/回滚。
- 观测指标：QPS、P95/P99、错误率、资源水位。

### 5.3 Cache
- 职责：重点保障`路由转发`。
- 容量：以峰值QPS和压测结果设定实例数。
- 故障策略：限流/熔断/降级/自动扩容/回滚。
- 观测指标：QPS、P95/P99、错误率、资源水位。

### 5.4 Primary Store
- 职责：重点保障`熔断降级`。
- 容量：以峰值QPS和压测结果设定实例数。
- 故障策略：限流/熔断/降级/自动扩容/回滚。
- 观测指标：QPS、P95/P99、错误率、资源水位。

### 5.5 MQ
- 职责：重点保障`灰度放量`。
- 容量：以峰值QPS和压测结果设定实例数。
- 故障策略：限流/熔断/降级/自动扩容/回滚。
- 观测指标：QPS、P95/P99、错误率、资源水位。

### 5.6 Observability
- 职责：重点保障`回滚恢复`。
- 容量：以峰值QPS和压测结果设定实例数。
- 故障策略：限流/熔断/降级/自动扩容/回滚。
- 观测指标：QPS、P95/P99、错误率、资源水位。

## 6. API设计
### 6.1 `POST /v1/gateway-rules`
- 必带字段：tenant_id / request_id / trace_id。
- 幂等要求：request_id+tenant_id唯一。
- 超时预算：客户端 < 网关 < 服务。
- 失败处理：可重试错误指数退避，不可重试直接失败。

### 6.2 `GET /v1/gateway-rules/{id}`
- 必带字段：tenant_id / request_id / trace_id。
- 幂等要求：request_id+tenant_id唯一。
- 超时预算：客户端 < 网关 < 服务。
- 失败处理：可重试错误指数退避，不可重试直接失败。

### 6.3 `POST /v1/gateway-rules/{id}/actions`
- 必带字段：tenant_id / request_id / trace_id。
- 幂等要求：request_id+tenant_id唯一。
- 超时预算：客户端 < 网关 < 服务。
- 失败处理：可重试错误指数退避，不可重试直接失败。

### 6.4 `GET /v1/gateway-rules/{id}/history`
- 必带字段：tenant_id / request_id / trace_id。
- 幂等要求：request_id+tenant_id唯一。
- 超时预算：客户端 < 网关 < 服务。
- 失败处理：可重试错误指数退避，不可重试直接失败。

### 6.5 `POST /v1/gateway-rules/batch`
- 必带字段：tenant_id / request_id / trace_id。
- 幂等要求：request_id+tenant_id唯一。
- 超时预算：客户端 < 网关 < 服务。
- 失败处理：可重试错误指数退避，不可重试直接失败。

### 6.6 `GET /v1/gateway-rules/search`
- 必带字段：tenant_id / request_id / trace_id。
- 幂等要求：request_id+tenant_id唯一。
- 超时预算：客户端 < 网关 < 服务。
- 失败处理：可重试错误指数退避，不可重试直接失败。

### 6.7 `POST /v1/gateway-rules/reconcile`
- 必带字段：tenant_id / request_id / trace_id。
- 幂等要求：request_id+tenant_id唯一。
- 超时预算：客户端 < 网关 < 服务。
- 失败处理：可重试错误指数退避，不可重试直接失败。

### 6.8 `GET /v1/gateway-rules/metrics`
- 必带字段：tenant_id / request_id / trace_id。
- 幂等要求：request_id+tenant_id唯一。
- 超时预算：客户端 < 网关 < 服务。
- 失败处理：可重试错误指数退避，不可重试直接失败。

## 7. 数据模型
### 7.1 `rate_plan`
```sql
CREATE TABLE rate_plan (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  tenant_id BIGINT NOT NULL,
  rate_plan_key VARCHAR(128) NOT NULL,
  status VARCHAR(32) NOT NULL,
  payload JSON NOT NULL,
  version BIGINT NOT NULL DEFAULT 0,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uk_tenant_1 (tenant_id, rate_plan_key),
  KEY idx_status_time (status, updated_at)
);
```
- 备注：围绕读写路径建立索引，避免过度索引影响写入。

### 7.2 `quota_counter`
```sql
CREATE TABLE quota_counter (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  tenant_id BIGINT NOT NULL,
  quota_counter_key VARCHAR(128) NOT NULL,
  status VARCHAR(32) NOT NULL,
  payload JSON NOT NULL,
  version BIGINT NOT NULL DEFAULT 0,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uk_tenant_2 (tenant_id, quota_counter_key),
  KEY idx_status_time (status, updated_at)
);
```
- 备注：围绕读写路径建立索引，避免过度索引影响写入。

### 7.3 `route_policy`
```sql
CREATE TABLE route_policy (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  tenant_id BIGINT NOT NULL,
  route_policy_key VARCHAR(128) NOT NULL,
  status VARCHAR(32) NOT NULL,
  payload JSON NOT NULL,
  version BIGINT NOT NULL DEFAULT 0,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uk_tenant_3 (tenant_id, route_policy_key),
  KEY idx_status_time (status, updated_at)
);
```
- 备注：围绕读写路径建立索引，避免过度索引影响写入。

### 7.4 `circuit_state`
```sql
CREATE TABLE circuit_state (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  tenant_id BIGINT NOT NULL,
  circuit_state_key VARCHAR(128) NOT NULL,
  status VARCHAR(32) NOT NULL,
  payload JSON NOT NULL,
  version BIGINT NOT NULL DEFAULT 0,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uk_tenant_4 (tenant_id, circuit_state_key),
  KEY idx_status_time (status, updated_at)
);
```
- 备注：围绕读写路径建立索引，避免过度索引影响写入。

### 7.5 `gateway_log`
```sql
CREATE TABLE gateway_log (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  tenant_id BIGINT NOT NULL,
  gateway_log_key VARCHAR(128) NOT NULL,
  status VARCHAR(32) NOT NULL,
  payload JSON NOT NULL,
  version BIGINT NOT NULL DEFAULT 0,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uk_tenant_5 (tenant_id, gateway_log_key),
  KEY idx_status_time (status, updated_at)
);
```
- 备注：围绕读写路径建立索引，避免过度索引影响写入。

### 7.6 `tenant_profile`
```sql
CREATE TABLE tenant_profile (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  tenant_id BIGINT NOT NULL,
  tenant_profile_key VARCHAR(128) NOT NULL,
  status VARCHAR(32) NOT NULL,
  payload JSON NOT NULL,
  version BIGINT NOT NULL DEFAULT 0,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uk_tenant_6 (tenant_id, tenant_profile_key),
  KEY idx_status_time (status, updated_at)
);
```
- 备注：围绕读写路径建立索引，避免过度索引影响写入。

### 7.7 `release_record`
```sql
CREATE TABLE release_record (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  tenant_id BIGINT NOT NULL,
  release_record_key VARCHAR(128) NOT NULL,
  status VARCHAR(32) NOT NULL,
  payload JSON NOT NULL,
  version BIGINT NOT NULL DEFAULT 0,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uk_tenant_7 (tenant_id, release_record_key),
  KEY idx_status_time (status, updated_at)
);
```
- 备注：围绕读写路径建立索引，避免过度索引影响写入。

### 7.8 `audit_log`
```sql
CREATE TABLE audit_log (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  tenant_id BIGINT NOT NULL,
  audit_log_key VARCHAR(128) NOT NULL,
  status VARCHAR(32) NOT NULL,
  payload JSON NOT NULL,
  version BIGINT NOT NULL DEFAULT 0,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uk_tenant_8 (tenant_id, audit_log_key),
  KEY idx_status_time (status, updated_at)
);
```
- 备注：围绕读写路径建立索引，避免过度索引影响写入。

## 8. 关键流程
### 8.1 主写流程
1. Gateway完成鉴权、限流与trace注入。
2. API Service执行`接入鉴权`并做幂等校验。
3. Primary Store事务提交`配额判定`状态。
4. MQ异步扩散并由Worker完成`路由转发`。
5. Observability打点并告警。
6. 失败路径进入重试/补偿队列。

### 8.2 主读流程
1. Gateway完成鉴权、限流与trace注入。
2. API Service执行`配额判定`并做幂等校验。
3. Primary Store事务提交`路由转发`状态。
4. MQ异步扩散并由Worker完成`熔断降级`。
5. Observability打点并告警。
6. 失败路径进入重试/补偿队列。

### 8.3 异步补偿流程
1. Gateway完成鉴权、限流与trace注入。
2. API Service执行`路由转发`并做幂等校验。
3. Primary Store事务提交`熔断降级`状态。
4. MQ异步扩散并由Worker完成`灰度放量`。
5. Observability打点并告警。
6. 失败路径进入重试/补偿队列。

### 8.4 回滚恢复流程
1. Gateway完成鉴权、限流与trace注入。
2. API Service执行`熔断降级`并做幂等校验。
3. Primary Store事务提交`灰度放量`状态。
4. MQ异步扩散并由Worker完成`回滚恢复`。
5. Observability打点并告警。
6. 失败路径进入重试/补偿队列。

### 8.5 灰度发布流程
1. Gateway完成鉴权、限流与trace注入。
2. API Service执行`灰度放量`并做幂等校验。
3. Primary Store事务提交`回滚恢复`状态。
4. MQ异步扩散并由Worker完成`接入鉴权`。
5. Observability打点并告警。
6. 失败路径进入重试/补偿队列。

### 8.6 高峰扩容流程
1. Gateway完成鉴权、限流与trace注入。
2. API Service执行`回滚恢复`并做幂等校验。
3. Primary Store事务提交`接入鉴权`状态。
4. MQ异步扩散并由Worker完成`配额判定`。
5. Observability打点并告警。
6. 失败路径进入重试/补偿队列。

### 8.7 故障隔离流程
1. Gateway完成鉴权、限流与trace注入。
2. API Service执行`接入鉴权`并做幂等校验。
3. Primary Store事务提交`配额判定`状态。
4. MQ异步扩散并由Worker完成`路由转发`。
5. Observability打点并告警。
6. 失败路径进入重试/补偿队列。

### 8.8 对账校验流程
1. Gateway完成鉴权、限流与trace注入。
2. API Service执行`配额判定`并做幂等校验。
3. Primary Store事务提交`路由转发`状态。
4. MQ异步扩散并由Worker完成`熔断降级`。
5. Observability打点并告警。
6. 失败路径进入重试/补偿队列。

## 9. 关键代码（面试重点）
```java
// 同步写路径：幂等 -> 事务 -> Outbox
Result handle(Command cmd) {
  Result replay = idem.find(cmd.requestId());
  if (replay != null) return replay;
  Tx tx = db.begin();
  try {
    long id = db.insertMain(cmd.payload());
    db.insertOutbox(id, cmd.traceId());
    tx.commit();
    Result ok = Result.ok(id, cmd.traceId());
    idem.save(cmd.requestId(), ok);
    return ok;
  } catch (Exception e) { tx.rollback(); throw e; }
}
```
```python
# 异步消费：指数退避 + 死信
def consume(msg):
    for i in range(1, 7):
        try:
            process(msg)
            ack(msg)
            return
        except TemporaryError:
            if i == 6:
                dead_letter(msg)
                return
            sleep(min(2 ** i, 60))
```

## 10. 算法边界与替代方案
### 10.1 `令牌桶`
- 适用边界：适用于关键链路优化
- 替代方案：先用可回滚简单方案
- 额外要掌握：补齐边界条件与演练数据

### 10.2 `漏桶`
- 适用边界：适用于关键链路优化
- 替代方案：先用可回滚简单方案
- 额外要掌握：补齐边界条件与演练数据

### 10.3 `滑动窗口`
- 适用边界：适用于关键链路优化
- 替代方案：先用可回滚简单方案
- 额外要掌握：补齐边界条件与演练数据

### 10.4 `幂等键+请求去重`
- 适用边界：请求重试场景
- 替代方案：幂等键+唯一约束+状态机
- 额外要掌握：跨服务透传幂等键

### 10.5 `指数退避`
- 适用边界：可重试故障
- 替代方案：退避+抖动+上限
- 额外要掌握：重试预算要纳入总超时

### 10.6 `一致性哈希`
- 适用边界：分片扩缩容
- 替代方案：虚拟节点+热点治理
- 额外要掌握：迁移回滚预案

## 11. 故障演练
### 11.01 演练：接入鉴权（压测窗口）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`令牌桶`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.02 演练：配额判定（灰度窗口）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`漏桶`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.03 演练：路由转发（跨AZ）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`滑动窗口`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.04 演练：熔断降级（发布后）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`幂等键+请求去重`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.05 演练：灰度放量（回滚后）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`指数退避`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.06 演练：回滚恢复（峰值活动）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`一致性哈希`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.07 演练：上游突发流量导致入口拥塞（低峰巡检）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`令牌桶`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.08 演练：缓存失效导致回源放大（依赖降级）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`漏桶`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.09 演练：数据库连接池耗尽（压测窗口）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`滑动窗口`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.10 演练：队列积压持续上升（灰度窗口）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`幂等键+请求去重`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.11 演练：发布后错误率异常（跨AZ）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`指数退避`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.12 演练：跨可用区网络抖动（发布后）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`一致性哈希`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.13 演练：依赖限流引发级联失败（回滚后）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`令牌桶`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.14 演练：配置误推导致规则异常（峰值活动）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`漏桶`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.15 演练：监控采样不足造成定位困难（低峰巡检）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`滑动窗口`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.16 演练：重试风暴导致资源耗尽（依赖降级）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`幂等键+请求去重`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.17 演练：接入鉴权（压测窗口）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`指数退避`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.18 演练：配额判定（灰度窗口）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`一致性哈希`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.19 演练：路由转发（跨AZ）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`令牌桶`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.20 演练：熔断降级（发布后）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`漏桶`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.21 演练：灰度放量（回滚后）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`滑动窗口`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.22 演练：回滚恢复（峰值活动）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`幂等键+请求去重`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.23 演练：上游突发流量导致入口拥塞（低峰巡检）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`指数退避`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

### 11.24 演练：缓存失效导致回源放大（依赖降级）
- 目标：验证P0边界与SLO可达。
- 触发：在预发注入延迟/超时/限流/错误率抬升。
- 观察：P95/P99、错误率、重试率、积压量。
- 止血：使用`一致性哈希`相关策略并灰度放量。
- 复盘：根因、修复项、防再发项、下次演练时间。

## 12. 同类题迁移与差异
| 子题 | 与母题相同 | 与母题不同 | 需补充知识 |
|---|---|---|---|
| Q37 API Rate Limiter (API限流器) | 架构骨架与演练方法可复用 | 业务目标与SLO侧重不同 | 多维配额与限流误伤控制 |
| Q50 Design API Rate Limiter | 架构骨架与演练方法可复用 | 业务目标与SLO侧重不同 | 多维配额与限流误伤控制 |
| Q100 Design Load Balancer | 架构骨架与演练方法可复用 | 业务目标与SLO侧重不同 | 在母题基础上补齐该题的业务目标和SLO差异 |

## 13. 上场前Checklist
- [ ] [001] 是否讲清`核心链路稳定`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [002] 是否讲清`高并发处理`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [003] 是否讲清`一致性保障`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [004] 是否讲清`故障恢复`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [005] 是否讲清`成本优化`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [006] 是否讲清`Gateway`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [007] 是否讲清`API Service`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [008] 是否讲清`Cache`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [009] 是否讲清`Primary Store`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [010] 是否讲清`MQ`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [011] 是否讲清`Observability`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [012] 是否讲清`幂等控制`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [013] 是否讲清`指数退避`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [014] 是否讲清`一致性哈希`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [015] 是否讲清`读写分离`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [016] 是否讲清`观测告警`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [017] 是否讲清`回滚恢复`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [018] 是否讲清`核心链路稳定`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [019] 是否讲清`高并发处理`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [020] 是否讲清`一致性保障`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [021] 是否讲清`故障恢复`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [022] 是否讲清`成本优化`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [023] 是否讲清`Gateway`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [024] 是否讲清`API Service`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [025] 是否讲清`Cache`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [026] 是否讲清`Primary Store`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [027] 是否讲清`MQ`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [028] 是否讲清`Observability`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [029] 是否讲清`幂等控制`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [030] 是否讲清`指数退避`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [031] 是否讲清`一致性哈希`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [032] 是否讲清`读写分离`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [033] 是否讲清`观测告警`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [034] 是否讲清`回滚恢复`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [035] 是否讲清`核心链路稳定`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [036] 是否讲清`高并发处理`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [037] 是否讲清`一致性保障`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [038] 是否讲清`故障恢复`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [039] 是否讲清`成本优化`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [040] 是否讲清`Gateway`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [041] 是否讲清`API Service`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [042] 是否讲清`Cache`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [043] 是否讲清`Primary Store`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [044] 是否讲清`MQ`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [045] 是否讲清`Observability`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [046] 是否讲清`幂等控制`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [047] 是否讲清`指数退避`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [048] 是否讲清`一致性哈希`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [049] 是否讲清`读写分离`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [050] 是否讲清`观测告警`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [051] 是否讲清`回滚恢复`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [052] 是否讲清`核心链路稳定`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [053] 是否讲清`高并发处理`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [054] 是否讲清`一致性保障`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [055] 是否讲清`故障恢复`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [056] 是否讲清`成本优化`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [057] 是否讲清`Gateway`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [058] 是否讲清`API Service`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [059] 是否讲清`Cache`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [060] 是否讲清`Primary Store`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [061] 是否讲清`MQ`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [062] 是否讲清`Observability`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [063] 是否讲清`幂等控制`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [064] 是否讲清`指数退避`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [065] 是否讲清`一致性哈希`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [066] 是否讲清`读写分离`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [067] 是否讲清`观测告警`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [068] 是否讲清`回滚恢复`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [069] 是否讲清`核心链路稳定`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [070] 是否讲清`高并发处理`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [071] 是否讲清`一致性保障`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [072] 是否讲清`故障恢复`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [073] 是否讲清`成本优化`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [074] 是否讲清`Gateway`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [075] 是否讲清`API Service`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [076] 是否讲清`Cache`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [077] 是否讲清`Primary Store`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [078] 是否讲清`MQ`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [079] 是否讲清`Observability`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [080] 是否讲清`幂等控制`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [081] 是否讲清`指数退避`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [082] 是否讲清`一致性哈希`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [083] 是否讲清`读写分离`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [084] 是否讲清`观测告警`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [085] 是否讲清`回滚恢复`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [086] 是否讲清`核心链路稳定`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [087] 是否讲清`高并发处理`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [088] 是否讲清`一致性保障`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [089] 是否讲清`故障恢复`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [090] 是否讲清`成本优化`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [091] 是否讲清`Gateway`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [092] 是否讲清`API Service`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [093] 是否讲清`Cache`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [094] 是否讲清`Primary Store`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [095] 是否讲清`MQ`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [096] 是否讲清`Observability`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [097] 是否讲清`幂等控制`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [098] 是否讲清`指数退避`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [099] 是否讲清`一致性哈希`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [100] 是否讲清`读写分离`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [101] 是否讲清`观测告警`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [102] 是否讲清`回滚恢复`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [103] 是否讲清`核心链路稳定`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [104] 是否讲清`高并发处理`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [105] 是否讲清`一致性保障`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [106] 是否讲清`故障恢复`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [107] 是否讲清`成本优化`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [108] 是否讲清`Gateway`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [109] 是否讲清`API Service`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [110] 是否讲清`Cache`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [111] 是否讲清`Primary Store`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [112] 是否讲清`MQ`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [113] 是否讲清`Observability`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [114] 是否讲清`幂等控制`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？
- [ ] [115] 是否讲清`指数退避`在`接入鉴权`场景下的边界、SLO、故障策略，并说明`令牌桶`如何落地？
- [ ] [116] 是否讲清`一致性哈希`在`配额判定`场景下的边界、SLO、故障策略，并说明`漏桶`如何落地？
- [ ] [117] 是否讲清`读写分离`在`路由转发`场景下的边界、SLO、故障策略，并说明`滑动窗口`如何落地？
- [ ] [118] 是否讲清`观测告警`在`熔断降级`场景下的边界、SLO、故障策略，并说明`幂等键+请求去重`如何落地？
- [ ] [119] 是否讲清`回滚恢复`在`灰度放量`场景下的边界、SLO、故障策略，并说明`指数退避`如何落地？
- [ ] [120] 是否讲清`核心链路稳定`在`回滚恢复`场景下的边界、SLO、故障策略，并说明`一致性哈希`如何落地？

## 14. 面试追问题库
### [Q001] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q002] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q003] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q004] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q005] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q006] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q007] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q008] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q009] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q010] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q011] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q012] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q013] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q014] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q015] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q016] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q017] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q018] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q019] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q020] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q021] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q022] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q023] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q024] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q025] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q026] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q027] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q028] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q029] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q030] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q031] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q032] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q033] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q034] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q035] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q036] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q037] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q038] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q039] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q040] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q041] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q042] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q043] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q044] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q045] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q046] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q047] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q048] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q049] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q050] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q051] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q052] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q053] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q054] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q055] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q056] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q057] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q058] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q059] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q060] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q061] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q062] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q063] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q064] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q065] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q066] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q067] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q068] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q069] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q070] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q071] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q072] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q073] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q074] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q075] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q076] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q077] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q078] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q079] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q080] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q081] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q082] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q083] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q084] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q085] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q086] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q087] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q088] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q089] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q090] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q091] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q092] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q093] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q094] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q095] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q096] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q097] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q098] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q099] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q100] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q101] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q102] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q103] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q104] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q105] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q106] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q107] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q108] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q109] 在`接入鉴权`环节P99翻倍时，你如何定位并止血？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q110] 为什么`配额判定`要放在同步链路而不是异步链路？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q111] `滑动窗口`在`路由转发`里什么时候会失效，你如何兜底？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q112] 如果`熔断降级`误伤高价值请求，你怎么做灰度回退？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q113] `灰度放量`命中率下降时，你先看哪些观测指标？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q114] 如何证明`回滚恢复`的审计链路可回放、可追责？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q115] 为什么这里选`令牌桶`而不是更强一致方案？
- 面试官意图：验证你对`接入鉴权`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`令牌桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q116] 跨可用区抖动时，`配额判定`的RTO/RPO如何保证？
- 面试官意图：验证你对`配额判定`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`漏桶`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q117] 流量突增3倍时，`路由转发`先扩哪层，依据是什么？
- 面试官意图：验证你对`路由转发`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`滑动窗口`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q118] 如果发布导致`熔断降级`错误率上涨，如何10分钟回滚？
- 面试官意图：验证你对`熔断降级`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`幂等键+请求去重`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q119] `灰度放量`与下游依赖同时抖动时，你如何避免级联失败？
- 面试官意图：验证你对`灰度放量`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`指数退避`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

### [Q120] 如何用压测证明`一致性哈希`在`回滚恢复`链路确实有效？
- 面试官意图：验证你对`回滚恢复`的真实落地经验。
- 推荐答法：现象 -> 指标 -> 定位 -> 止血 -> 根因 -> 长效修复。
- 易错点：不讲边界、不讲取舍；没解释`一致性哈希`在该处为何可行。
- 可量化指标：成功率、P95/P99、错误率、重试率、恢复时长。

## 15. 30秒总结
- 先定义P0和SLO，再按容量估算给架构。
- 用幂等+重试+补偿保证一致性和可恢复。
- 用演练与回滚方案证明可执行。
